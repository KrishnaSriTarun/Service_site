generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

//
// ==================== USER (Stored in DB) ====================
//

model User {
  id        String    @id @map("_id") // Clerk ID
  name      String
  phone     String?
  email     String?
  role      String    @default("customer")
  createdAt DateTime  @default(now())
  
  bookings  Booking[] @relation("UserBookings")
}

//
// ==================== PROVIDER (Stored in DB) ====================
//

model Provider {
  id         String    @id @default(auto()) @map("_id") @db.ObjectId
  userId     String
  name       String
  category   String
  experience Int?
  price      Float?
  photoUrl   String?
  createdAt  DateTime  @default(now())
  updatedAt  DateTime  @updatedAt

  bookings   Booking[] @relation("ProviderBookings")
}

//
// ==================== BOOKING (Relation to User & Provider) ====================
//

model Booking {
  id          String    @id @default(auto()) @map("_id") @db.ObjectId

  customerId  String
  providerId  String    @db.ObjectId

  user        User      @relation("UserBookings", fields: [customerId], references: [id])
  provider    Provider  @relation("ProviderBookings", fields: [providerId], references: [id])

  status      String    @default("pending")
  address     String
  description String
  price       Float
  createdAt   DateTime  @default(now())
  completedAt DateTime?
}
